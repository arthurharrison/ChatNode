<!DOCTYPE html>
<html>
  <head>
    <title>ChatNode</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css" />
  </head>
  <body>
    <div class='chatter' id='chatter'>
      <div id="history"></div>
      <form id="chat">
        <input type="user" id="user_text" placeholder="username" name="user_text" />
        <input type="text" placeholder="text" id="msg_text" name="msg_text" />
        <input type="submit" value="Send!" />
      </form>
    </div>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
      var socket = io.connect();
      $("form#chat").submit(function(e) {
          e.preventDefault();
          socket.emit("send message", $(this).find("#user_text").val() + " - " + $(this).find("#msg_text").val(), function() {
              $("form#chat #msg_text").val("");
          });
      });

      socket.on('chat message', function(msg){
        //handle the message however you would like
        $('#history').append($('<p />').text(msg));

      });

      socket.on("update messages", function(msg){
        var final_message = $("<p />").text(msg);
        $("#history").append(final_message);
      });
    </script>
  </body>
</html>
